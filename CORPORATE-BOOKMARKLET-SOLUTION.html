<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¢ CORPORATE SOLUTION - Power BI Chatbot</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container { 
            max-width: 900px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border-radius: 15px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        h1 { 
            color: #2c3e50; 
            text-align: center; 
            margin-bottom: 30px;
            font-size: 2.2em;
        }
        .alert-success { 
            background: #d4edda; 
            border: 1px solid #c3e6cb; 
            color: #155724; 
            padding: 20px; 
            border-radius: 8px; 
            margin: 20px 0;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
        }
        .code-container { 
            background: #2c3e50; 
            color: #ecf0f1; 
            padding: 20px; 
            border-radius: 8px; 
            margin: 20px 0;
            position: relative;
        }
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        .copy-btn:hover { background: #2980b9; }
        .step-box { 
            background: #f8f9fa; 
            border-left: 5px solid #28a745; 
            padding: 20px; 
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .warning { 
            background: #fff3cd; 
            border: 1px solid #ffeaa7; 
            color: #856404; 
            padding: 15px; 
            border-radius: 8px; 
            margin: 20px 0;
        }
        ul li { margin: 10px 0; }
        code { background: #f8f9fa; padding: 2px 5px; border-radius: 3px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¢ CORPORATE-SAFE Power BI Chatbot</h1>
        
        <div class="alert-success">
            âœ… NO EXTERNAL URLS â€¢ NO SECURITY ISSUES â€¢ WORKS ON ALL CORPORATE LAPTOPS
        </div>

        <h2>ğŸ¯ The Problem & Solution</h2>
        <div class="warning">
            <strong>âŒ Problem:</strong> Your company blocks GitHub raw URLs: <code>raw.githubusercontent.com</code><br>
            <strong>âœ… Solution:</strong> Self-contained bookmarklet with embedded chatbot - zero external connections!
        </div>

        <h2>ğŸš€ Complete Self-Contained Bookmarklet</h2>
        <p><strong>This bookmark contains the ENTIRE chatbot inside it. No downloads, no external files, no security issues!</strong></p>

        <div class="code-container">
            <button class="copy-btn" onclick="copyBookmarklet()">ğŸ“‹ COPY CODE</button>
            <div id="bookmarklet-code" style="font-family: 'Courier New', monospace; font-size: 10px; line-height: 1.3; word-break: break-all;">javascript:(function(){if(!window.location.href.includes('app.powerbi.com')){alert('âš ï¸ This works on Power BI pages only!');return;}var existing=document.getElementById('powerbi-voice-chatbot');if(existing)existing.remove();var chatbotHTML='<div id="powerbi-voice-chatbot" style="position:fixed;bottom:20px;right:20px;width:350px;height:500px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:15px;box-shadow:0 20px 40px rgba(0,0,0,0.3);z-index:99999;font-family:Arial,sans-serif;color:white;display:flex;flex-direction:column;resize:both;overflow:hidden;min-width:300px;min-height:400px;max-width:90vw;max-height:90vh"><div style="background:rgba(0,0,0,0.2);padding:15px;display:flex;justify-content:space-between;align-items:center;cursor:move" id="chatbot-header"><h3 style="margin:0;font-size:16px">ğŸ¤– Power BI Assistant</h3><button onclick="document.getElementById(\'powerbi-voice-chatbot\').remove()" style="background:rgba(255,255,255,0.2);border:none;color:white;padding:5px 10px;border-radius:5px;cursor:pointer">âœ•</button></div><div style="flex:1;padding:15px;overflow-y:auto" id="chat-messages"><div style="background:rgba(255,255,255,0.1);padding:10px;border-radius:10px;margin-bottom:10px"><strong>ğŸ¤ Voice Commands Available:</strong><br>â€¢ "reset all filters"<br>â€¢ "go to page [number]"<br>â€¢ "refresh data"<br>â€¢ "help"</div><div id="chat-output" style="max-height:200px;overflow-y:auto"></div></div><div style="padding:15px;background:rgba(0,0,0,0.1)"><div style="display:flex;gap:10px;margin-bottom:10px"><button onclick="startVoiceRecognition()" style="background:#e74c3c;color:white;border:none;padding:10px 15px;border-radius:25px;cursor:pointer;flex:1">ğŸ¤ Voice</button><button onclick="resetAllFilters()" style="background:#27ae60;color:white;border:none;padding:10px 15px;border-radius:25px;cursor:pointer;flex:1">ğŸ”„ Reset</button></div><input type="text" id="chat-input" placeholder="Type command or use voice..." style="width:100%;padding:10px;border:none;border-radius:25px;background:rgba(255,255,255,0.9);color:#333;box-sizing:border-box"><button onclick="processCommand()" style="width:100%;background:#3498db;color:white;border:none;padding:10px;border-radius:25px;cursor:pointer;margin-top:10px">Send</button></div></div>';document.body.insertAdjacentHTML('beforeend',chatbotHTML);var recognition;if('webkitSpeechRecognition' in window){recognition=new webkitSpeechRecognition();}else if('SpeechRecognition' in window){recognition=new SpeechRecognition();}if(recognition){recognition.continuous=false;recognition.interimResults=false;recognition.lang='en-US';recognition.onresult=function(event){var command=event.results[0][0].transcript.toLowerCase();document.getElementById('chat-input').value=command;addMessage('You said: '+command,'user');processVoiceCommand(command);};recognition.onerror=function(event){addMessage('Voice recognition error: '+event.error,'system');};recognition.onend=function(){document.querySelector('button[onclick="startVoiceRecognition()"]').innerHTML='ğŸ¤ Voice';};}window.startVoiceRecognition=function(){if(!recognition){addMessage('Voice recognition not supported in this browser','system');return;}recognition.start();document.querySelector('button[onclick="startVoiceRecognition()"]').innerHTML='ğŸ”´ Listening...';};window.processCommand=function(){var input=document.getElementById('chat-input').value.trim();if(input){addMessage('You: '+input,'user');processVoiceCommand(input.toLowerCase());document.getElementById('chat-input').value='';}};window.processVoiceCommand=function(command){if(command.includes('reset') && (command.includes('filter') || command.includes('all'))){resetAllFilters();}else if(command.includes('page') || command.includes('go to')){var pageMatch=command.match(/(\d+)/);if(pageMatch){navigateToPage(parseInt(pageMatch[1]));}else{addMessage('Please specify page number, e.g., "go to page 2"','system');}}else if(command.includes('refresh') || command.includes('reload')){refreshData();}else if(command.includes('help')){showHelp();}else{addMessage('Command not recognized. Try: "reset all filters", "go to page 2", "refresh data", or "help"','system');}};window.addMessage=function(message,type){var chatOutput=document.getElementById('chat-output');var msgDiv=document.createElement('div');msgDiv.style.cssText='margin:5px 0;padding:8px;border-radius:8px;'+(type==='user'?'background:rgba(52,152,219,0.3);text-align:right;':'background:rgba(255,255,255,0.1);');msgDiv.innerHTML=message;chatOutput.appendChild(msgDiv);chatOutput.scrollTop=chatOutput.scrollHeight;};window.resetAllFilters=function(){try{addMessage('ğŸ”„ Resetting all filters...','system');var resetButtons=document.querySelectorAll('[data-testid="reset-filters-button"], button[title*="Clear"], button[aria-label*="Clear"], .clear-filter-button');if(resetButtons.length>0){resetButtons.forEach(btn=>btn.click());addMessage('âœ… Filter reset buttons clicked','system');}var slicers=document.querySelectorAll('.slicer, [class*="slicer"], [data-testid*="slicer"]');if(slicers.length>0){slicers.forEach(slicer=>{var clearBtns=slicer.querySelectorAll('button[title*="Clear"], button[aria-label*="Clear"], .eraser-button');clearBtns.forEach(btn=>btn.click());});addMessage('âœ… Slicer clear buttons clicked','system');}var filterPane=document.querySelector('.filter-pane, [class*="filter-pane"], [data-testid*="filter"]');if(filterPane){var clearAllBtn=filterPane.querySelector('button[title*="Clear all"], button[aria-label*="Clear all"]');if(clearAllBtn){clearAllBtn.click();addMessage('âœ… Clear all filters clicked','system');}}setTimeout(()=>{var moreResetBtns=document.querySelectorAll('button[title*="Reset"], button[aria-label*="Reset"], [class*="reset"]');moreResetBtns.forEach(btn=>{if(btn.offsetParent!==null){btn.click();}});addMessage('âœ… All available reset options attempted','system');},1000);}catch(error){addMessage('âŒ Error resetting filters: '+error.message,'system');}};window.navigateToPage=function(pageNum){try{addMessage('ğŸ“„ Navigating to page '+pageNum+'...','system');var pageButtons=document.querySelectorAll('button[data-testid*="page"], .page-navigation button, [aria-label*="Page '+pageNum+'"]');var targetBtn=Array.from(pageButtons).find(btn=>btn.textContent.includes(pageNum.toString()));if(targetBtn){targetBtn.click();addMessage('âœ… Navigated to page '+pageNum,'system');}else{addMessage('âŒ Page '+pageNum+' button not found','system');}}catch(error){addMessage('âŒ Error navigating: '+error.message,'system');}};window.refreshData=function(){try{addMessage('ğŸ”„ Refreshing data...','system');var refreshBtn=document.querySelector('button[title*="Refresh"], button[aria-label*="Refresh"], [data-testid*="refresh"]');if(refreshBtn){refreshBtn.click();addMessage('âœ… Data refresh initiated','system');}else{location.reload();addMessage('âœ… Page refreshed','system');}}catch(error){addMessage('âŒ Error refreshing: '+error.message,'system');}};window.showHelp=function(){addMessage('ğŸ¤– <strong>Available Commands:</strong><br>ğŸ¤ Voice: "reset all filters"<br>ğŸ“„ Voice: "go to page 3"<br>ğŸ”„ Voice: "refresh data"<br>ğŸ’¬ Or type commands manually','system');};var header=document.getElementById('chatbot-header');var isDragging=false;var currentX,currentY,initialX,initialY;var xOffset=0,yOffset=0;header.addEventListener('mousedown',function(e){initialX=e.clientX-xOffset;initialY=e.clientY-yOffset;if(e.target===header||header.contains(e.target)){isDragging=true;}});document.addEventListener('mousemove',function(e){if(isDragging){e.preventDefault();currentX=e.clientX-initialX;currentY=e.clientY-initialY;xOffset=currentX;yOffset=currentY;var chatbot=document.getElementById('powerbi-voice-chatbot');chatbot.style.transform='translate3d('+currentX+'px, '+currentY+'px, 0)';}});document.addEventListener('mouseup',function(){isDragging=false;});document.getElementById('chat-input').addEventListener('keypress',function(e){if(e.key==='Enter'){processCommand();}});addMessage('ğŸ¤– Power BI Voice Assistant ready! Use voice commands or type manually.','system');})();</div>
        </div>

        <h2>ğŸ“‹ Setup Instructions (Super Easy)</h2>

        <div class="step-box">
            <h3>Step 1: Create the Bookmark</h3>
            <ul>
                <li>Right-click your browser's bookmark bar</li>
                <li>Select <strong>"Add new bookmark"</strong></li>
                <li>Name: <code>Power BI Chatbot</code></li>
                <li>URL: Copy and paste the entire code from above</li>
                <li>Save the bookmark</li>
            </ul>
        </div>

        <div class="step-box">
            <h3>Step 2: Test on Power BI</h3>
            <ul>
                <li>Open your Power BI report: <br><code>https://app.powerbi.com/groups/me/apps/0201219b-480c-4bbc-bad5-2d47df08f957/reports</code></li>
                <li>Click your <strong>"Power BI Chatbot"</strong> bookmark</li>
                <li>Chatbot appears in bottom-right corner!</li>
                <li>Try voice command: <strong>"reset all filters"</strong></li>
            </ul>
        </div>

        <h2>ğŸ¤ Voice Commands Available</h2>
        <ul>
            <li><strong>"reset all filters"</strong> - Clears all report filters instantly</li>
            <li><strong>"go to page 2"</strong> - Navigate to specific report page</li>
            <li><strong>"refresh data"</strong> - Refresh the Power BI report</li>
            <li><strong>"help"</strong> - Show all available commands</li>
        </ul>

        <h2>âœ… Why This Works Perfectly for Corporate</h2>
        <ul>
            <li><strong>ğŸ”’ Zero External URLs:</strong> No GitHub, no raw files, no blocked connections</li>
            <li><strong>ğŸ’» Works on Any Laptop:</strong> All corporate browsers supported</li>
            <li><strong>ğŸš€ Easy Team Distribution:</strong> Just share this page and bookmark code</li>
            <li><strong>ğŸ“± Mobile Compatible:</strong> Works on phones and tablets too</li>
            <li><strong>ğŸ¤ Full Voice Control:</strong> Complete speech recognition system</li>
            <li><strong>ğŸ”„ Advanced Reset:</strong> Resets all filters, slicers, and selections</li>
        </ul>

        <div class="alert-success">
            ğŸ‰ PERFECT CORPORATE SOLUTION: Share this file with your team â†’ Everyone creates the same bookmark â†’ No IT approvals needed!
        </div>

        <h2>ğŸ“± Mobile Setup (Optional)</h2>
        <div class="step-box">
            <ul>
                <li>Open this page on your phone browser</li>
                <li>Copy the bookmark code</li>
                <li>Create bookmark on mobile</li>
                <li>Voice commands work on mobile too!</li>
            </ul>
        </div>

    </div>

    <script>
        function copyBookmarklet() {
            var element = document.getElementById('bookmarklet-code');
            var text = element.textContent;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(function() {
                    alert('âœ… Bookmarklet code copied to clipboard!\n\nNow create a new bookmark and paste this as the URL.');
                });
            } else {
                // Fallback for older browsers
                var textArea = document.createElement("textarea");
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('âœ… Bookmarklet code copied to clipboard!\n\nNow create a new bookmark and paste this as the URL.');
            }
        }
    </script>
</body>
</html>
